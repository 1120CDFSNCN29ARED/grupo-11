<%- include('head') %>
<body>
	<%- include('header') %>
	<main>
		<form id="carrito" action="/carrito/actualizar?_method=PUT" method="POST">
			<!--ENCABEZADO-->
			<section id="encabezado">
				<div id="título">
					<i class="fas fa-shopping-basket"></i>
					<h1>Carrito de Compras</h1>
				</div>
				<div>
					<% if (registros.length > 0) { %>
						<!--IMPORTE TOTAL Y PAGAR-->
						<div id="total">
							<h2>Importe a pagar:</h2>
							<% let acumulador = 0 %> 
							<% for (n of registros) { %>
								<% acumulador = acumulador + n.cantidad * n.producto.precio %> 
							<% } %> 
							<h2 id="importe">$ <%= toThousand(acumulador) %> </h2>
						</div>
						<!--CONTINUAR Y PAGAR-->
						<div id="continuar-y-pagar">
							<button type="submit">Guardar cambios</button>
							<button>Pagar</button>
						</div>
					<% } %>
				</div>
			</section>
			<!--REGISTROS-->
			<section>
				<% if (registros.length > 0) { %>
					<% let cantRegistros = registros.length %>
					<input class="ocultar" name="cantRegistros" type="number" value="<%= cantRegistros %>">
					<% for (let i = 0; i < cantRegistros; i++) { %>
						<%- include('carrito-registro', {
							numRegistro: i,
							registroID: registros[i].id,
							cantidad: registros[i].cantidad,
							producto: registros[i].producto, 
							imagen: registros[i].imagen,
							toThousand,
						}) %>
					<% } %>
				<% } else { %>
					<p id="carritoVacio">No tenés productos en el carrito</p>
				<% } %>
			</section>
		</form>
	</main>
	<%- include('footer') %>
</body>

</html>